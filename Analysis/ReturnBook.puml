@startuml ReturnBook
' ================================================
' Robustness Diagram: Return Book
' Library Management System | Prof. Walt Melo
' Group: G25
' ================================================

skinparam defaultFontSize 12
skinparam defaultFontName Arial

' Actors
actor Member
actor Librarian

' Boundary Objects (UI Elements)
boundary "Return\nCounter\nScreen" as ReturnScreen
boundary "Book Scan\nInterface" as ScanInterface
boundary "Return\nConfirmation" as ConfirmDialog
boundary "Fine Payment\nScreen" as FineScreen

' Control Objects (Business Logic)
control "Return\nController" as ReturnController
control "Due Date\nValidator" as DueDateValidator
control "Fine\nCalculator" as FineCalculator
control "Book Condition\nChecker" as ConditionChecker

' Entity Objects (Domain Model)
entity "Book" as Book
entity "Member" as MemberEntity
entity "Loan Record" as LoanRecord
entity "Transaction" as Transaction
entity "Fine Record" as FineRecord

' Interactions
Member -> ReturnScreen : Initiate book return
Librarian -> ReturnScreen : Process book return

ReturnScreen -> ScanInterface : Scan book barcode/ISBN
ScanInterface -> ReturnController : Submit book ID & member ID

ReturnController -> LoanRecord : Retrieve loan information
LoanRecord -> Transaction : Get transaction details

ReturnController -> DueDateValidator : Check return date vs due date
DueDateValidator -> ReturnController : Return validation result

alt If book is overdue
    ReturnController -> FineCalculator : Calculate fine amount
    FineCalculator -> FineRecord : Create fine record
    FineCalculator -> ReturnController : Return fine details
    ReturnController -> FineScreen : Display fine (extends to Pay Fine)
    FineScreen -> Member : Show fine amount
    note right of FineScreen
      **extend relationship**
      triggers Pay Fine use case
    end note
end

ReturnController -> ConditionChecker : Verify book condition
ConditionChecker -> Book : Check for damage

ReturnController -> Book : Update status to "Available"
ReturnController -> LoanRecord : Close loan record
ReturnController -> Transaction : Update transaction status
ReturnController -> MemberEntity : Update member's borrowed books

ReturnController -> ConfirmDialog : Provide return confirmation
ConfirmDialog -> Member : Display return receipt
ConfirmDialog -> Librarian : Show updated status

@enduml
